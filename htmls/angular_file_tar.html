{% extends "main.html" %}

{% block title_content %}
  : Directory and tar file views
{% endblock %}

{% block head_content %}
<link href="/css/abn_tree.css" rel="stylesheet"/>
{% endblock %}


{% block body_content %}
<div class="container">

  <div class="row" id="row_1" >
       <div ng-app="file_tar_module" id="file_tar_source_id">
       <div ng-controller="fileTarController">

       <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
       <div class="col-md-9 col-md-push-3">right column: .col-md-3 .col-md-push-3
        <div ng-app ng-init="tab=1">
            <div class="tabs" ng-click="tab = 1">Tree View</div>
            <div class="tabs" ng-click="tab = 2">List View</div>

            <div ng-show="tab == 1">

                <!--div ng-show="fileTarScope.source_list != null"-->

                    <div ng-app="angularBootstrapNavTree" id="nav_tree_id">
                        <!--span ng-bind="fileTarScope.dir_structure.toSource()">Here</span-->
                        <abn-tree tree-data="fileTarScope.dir_structure" icon-leaf="icon-file"
                             icon-expand="icon-plus-sign" icon-contract="icon-minus-sign" 
                             on-select="my_tree_handler(branch)" expand-level="2"></abn-tree>
                    </div>

                <!--/div-->

            </div><!-- ng-show tab = 1-->

            <div ng-show="tab == 2">

                <div ng-show="fileTarScope.source_list != null">
                   <table>
                       <tr ng-repeat="f in fileTarScope.source_list">
                           <td>File: <span ng-bind="f"><span></td>
                       </tr>
                   </table>
                </div>

            </div><!-- ng-show tab = 2-->
        </div>

       </div><!-- col-md-9 -->

       <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
       <div class="col-md-3 col-md-pull-9">left column: .col-md-9 .col-md-pull-9

       <form ng-submit="fileTarScope.get_source_list()" id="fts_api_form_id" name="fts_api_form">
           <input type="text" ng-model="fileTarScope.listing_type" ng-init="fileTarScope.listing_type='1'" required>Listing Type (1=short, 2=long)</input><br>
           <input type="text" ng-model="fileTarScope.source" ng-init="fileTarScope.source='dir'" required>Source (dir/tar)</input><br>
           <input type="submit" id="submit" value="list files from source"></input>
       </form>

       <container-directive>
       <div ng-show="fileTarScope.source_list != null">
           <p>Total of <span ng-bind="fileTarScope.source_list.length"></span> entries.</p>
           <table>
               <tr ng-repeat="(t,num) in fileTarScope.source_list">
                   <td><span ng-bind="num"></span> of type <span ng-bind="t"></span></td>
               </tr>
           </table>
           <span ng-repeat="(t,num) in fileTarScope.source_list.results.ftypes">
               <label class="checkbox" for="{{t}}">
               <input type="checkbox" ng-model="fileTarScope.source_list.results.ftypes" name="cts_filetypes" id="{{t}}" />
               {{t}}
               </label>
           </span>
       </div><!-- ng-show -->
       </container-directive>

       </div> <!-- col-md-3 -->

       </div><!-- ng-controller -->
       </div><!-- ng-app -->

  </div><!-- row_1 -->

{% block script_content %}
    <script src="http://127.0.0.1:8000/js/angular_file_tar.js" type="text/javascript" ></script>
    <script src="http://127.0.0.1:8000/js/abn_tree_directive.js" type="text/javascript" ></script>


<script type="text/javascript">
    // Manual bootstrap is necessary for multiple angular controllers on the same page.
    angular.element(document).ready(function() {
        angular.bootstrap(document.getElementById('file_tar_source_id'), ['file_tar_module']);
   });
</script>

{% endblock %}<!-- script_content -->

{% endblock %}<!-- body_content -->
